
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>جريش - الطلب</title>
  <style>
    body { font-family: 'Arial'; background: #fffdf7; padding: 20px; }
    h1, h2 { color: #444; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    button { background-color: #2ecc71; color: #fff; padding: 6px 12px; border: none; border-radius: 4px; cursor: pointer; }
    button:hover { background-color: #27ae60; }
    .delete-btn { background:#e74c3c; margin-right:10px; padding:4px 8px; border-radius:4px; }
    .categories{max-width:1100px;margin:60px auto 40px;padding:0 16px}
    .categories h2{font-size:2.2rem;font-weight:700;color:#d35400;text-align:center;margin-bottom:28px}
    .grid{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
      gap:28px;
    }
    .card{
      height:380px;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      background:#fff;
      border-radius:16px;
      box-shadow:0 6px 14px rgba(0,0,0,.1);
      overflow:hidden;
      cursor:pointer;
      transition:transform .3s,box-shadow .3s
    }
    .card:hover{transform:translateY(-8px);box-shadow:0 14px 24px rgba(0,0,0,.15)}
    .card img{width:100%;height:220px;object-fit:cover;border-bottom:4px solid #d35400}
    .card h3{text-align:center;padding:20px;color:#d35400;font-weight:800;font-size:1.5rem}

    /* Mobile improvements: larger text/cards and horizontal scroll for categories */
    @media(max-width:600px){
      .categories{padding:0 4px}
      .categories h2{font-size:1.5rem}
      .grid{
        display:grid;
        grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
        gap:24px;
      }
      .card{
        min-width:0;
        max-width:100%;
        height:350px;
        flex:none;
        scroll-snap-align:none;
      }
      .card img{height:200px}
      .card h3{font-size:1.3rem;padding:16px}
    }
    #order-summary { background:#f0f0f0; padding:15px; border-radius:8px; margin-top:30px; }
    li { margin-bottom:8px; }
    .whatsapp-btn { background:#25D366; width:100%; padding:12px; font-size:16px; color:#fff; border:none; border-radius:4px; margin-top:10px; cursor:pointer; }
    .whatsapp-btn:hover { background:#1ebe5d; }
        .nav-links { margin-bottom: 20px; }
    .nav-links a { margin-left: 10px; color: #d35400; text-decoration: none; font-weight: bold; }
    .nav-links a:hover { text-decoration: underline; }
  </style>
  <body>
  <div class="nav-links">
    <a href="website.html">الصفحة الرئيسية</a>
    <a href="manakish.html">مناقيش</a>
    <a href="pizza.html">بيتزا</a>
    <a href="kaakeh.html">كعك</a>
    <a href="jreesh.html">جريش</a>
  </div>
  <div class="nav-links">
    <a href="website.html">الصفحة الرئيسية</a>
    <a href="manakish.html">مناقيش</a>
    <a href="pizza.html">بيتزا</a>
    <a href="moaajanat.html">معجنات</a>
    <a href="kaakeh.html">كعك</a>
  </div>
  <h1>قائمة الجريش</h1>

  <div class="categories">
    <h2>الجريش</h2>
    <div id="menu-grid" class="grid"></div>
    <div style="text-align:center;margin-top:18px;">
      <button id="prevPageBtn" style="margin:0 8px;display:none">السابق</button>
      <span id="pageInfo"></span>
      <button id="nextPageBtn" style="margin:0 8px;display:none">التالي</button>
    </div>
  </div>
  <h2>طلبك</h2>
  <ul id="order-list"></ul>
  <div id="order-summary"></div>
  <button class="whatsapp-btn" id="deliveryBtn">إرسال الطلب عبر واتساب</button>
  <div id="deliveryModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.4);z-index:2000;justify-content:center;align-items:center;">
    <div style="background:#fff;padding:32px 24px;border-radius:16px;max-width:90vw;width:350px;text-align:center;position:relative;">
      <button onclick="closeDeliveryModal()" style="position:absolute;top:10px;left:10px;background:none;border:none;font-size:1.5rem;color:#d35400;cursor:pointer">&times;</button>
      <h3 style="color:#d35400;margin-bottom:18px">اختر منطقة التوصيل</h3>
      <div style="display:flex;gap:10px;justify-content:center;margin-bottom:10px;">
        <label style="display:flex;align-items:center;gap:4px;font-size:1.1rem;cursor:pointer;">
          <input type="radio" name="deliveryType" value="with" checked style="accent-color:#d35400;"> مع توصيل
        </label>
        <label style="display:flex;align-items:center;gap:4px;font-size:1.1rem;cursor:pointer;">
          <input type="radio" name="deliveryType" value="without" style="accent-color:#d35400;"> بدون توصيل
        </label>
      </div>
      <select id="deliverySelect" style="width:100%;padding:10px 8px;font-size:1.1rem;margin-bottom:18px">
        <option value="">اختر المنطقة</option>
        <option value="saksakie">سكسكية - 100 ل.ل</option>
        <option value="loubie">لوبية - 200 ل.ل</option>
        <option value="bablie">بابليّة - 200 ل.ل</option>
        <option value="sarafand">الصرفند - 200 ل.ل</option>
        <option value="saksakie_khayzaran">سكسكية خيزران - 200 ل.ل</option>
      </select>
      <button onclick="sendWhatsAppOrder()" style="background:#d35400;color:#fff;font-weight:700;padding:12px 28px;border-radius:40px;font-size:1.1rem;border:none;cursor:pointer;">تأكيد وإرسال الطلب</button>
    </div>
  </div>
  <div id="deliveryModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.4);z-index:2000;justify-content:center;align-items:center;">
    <div style="background:#fff;padding:32px 24px;border-radius:16px;max-width:90vw;width:350px;text-align:center;position:relative;">
      <button onclick="closeDeliveryModal()" style="position:absolute;top:10px;left:10px;background:none;border:none;font-size:1.5rem;color:#d35400;cursor:pointer">&times;</button>
      <h3 style="color:#d35400;margin-bottom:18px">اختر منطقة التوصيل</h3>
      <div style="display:flex;gap:10px;justify-content:center;margin-bottom:10px;">
        <label style="display:flex;align-items:center;gap:4px;font-size:1.1rem;cursor:pointer;">
          <input type="radio" name="deliveryType" value="with" checked style="accent-color:#d35400;"> مع توصيل
        </label>
        <label style="display:flex;align-items:center;gap:4px;font-size:1.1rem;cursor:pointer;">
          <input type="radio" name="deliveryType" value="without" style="accent-color:#d35400;"> بدون توصيل
        </label>
      </div>
      <select id="deliverySelect" style="width:100%;padding:10px 8px;font-size:1.1rem;margin-bottom:18px">
        <option value="">اختر المنطقة</option>
        <option value="saksakie">سكسكية - 100 ل.ل</option>
        <option value="loubie">لوبية - 200 ل.ل</option>
        <option value="bablie">بابليّة - 200 ل.ل</option>
        <option value="sarafand">الصرفند - 200 ل.ل</option>
        <option value="saksakie_khayzaran">سكسكية خيزران - 200 ل.ل</option>
      </select>
      <button onclick="sendOrderToWhatsApp()" style="background:#d35400;color:#fff;font-weight:700;padding:12px 28px;border-radius:40px;font-size:1.1rem;border:none;cursor:pointer;">تأكيد وإرسال الطلب</button>
    </div>
  </div>
  <script>
    const menu = [
      { name: "جريش جبنة", normal: 110000, rolled: 130000 },
      { name: "جريش زعتر", normal: 100000, rolled: 120000 },
      { name: "جريش سبانخ", normal: 105000, rolled: 125000 },
      { name: "جريش لحمة", normal: 130000, rolled: 150000 },
      { name: "جريش مرتديلا", normal: 120000, rolled: 140000 },
    ];

    // Pagination variables
    const itemsPerPage = 3;
    let currentPage = 1;

    function renderMenuPage() {
      const grid = document.getElementById('menu-grid');
      grid.innerHTML = '';
      const start = (currentPage - 1) * itemsPerPage;
      const end = start + itemsPerPage;
      const pageItems = menu.slice(start, end);
      pageItems.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <h3>${item.name}</h3>
          <div style="flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center;">
            <div style="margin-bottom:12px;">
              <span style="font-weight:700;">عادي:</span> 
              ${item.normal ? `<span style='color:#27ae60;font-weight:700;'>${item.normal.toLocaleString()} ل.ل</span><br><button onclick=\"addToOrder('${item.name} - عادي',${item.normal})\">أطلب الآن</button>` : '<span class="unavailable">غير متوفر</span>'}
            </div>
            <div>
              <span style="font-weight:700;">مشروحة:</span> 
              ${item.rolled ? `<span style='color:#27ae60;font-weight:700;'>${item.rolled.toLocaleString()} ل.ل</span><br><button onclick=\"addToOrder('${item.name} - مشروحة',${item.rolled})\">أطلب الآن</button>` : '<span class="unavailable">غير متوفر</span>'}
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
      // Pagination controls
      const totalPages = Math.ceil(menu.length / itemsPerPage);
      document.getElementById('pageInfo').textContent = `صفحة ${currentPage} من ${totalPages}`;
      document.getElementById('prevPageBtn').style.display = currentPage > 1 ? '' : 'none';
      document.getElementById('nextPageBtn').style.display = currentPage < totalPages ? '' : 'none';
    }

    document.getElementById('prevPageBtn').onclick = function() {
      if(currentPage > 1) {
        currentPage--;
        renderMenuPage();
      }
    };
    document.getElementById('nextPageBtn').onclick = function() {
      const totalPages = Math.ceil(menu.length / itemsPerPage);
      if(currentPage < totalPages) {
        currentPage++;
        renderMenuPage();
      }
    };
    let order = JSON.parse(localStorage.getItem('order_all')) || {};
    function saveOrder() {
      localStorage.setItem('order_all', JSON.stringify(order));
    }
    function addToOrder(item, price) {
      if(order[item]) {
        order[item].quantity += 1;
      } else {
        order[item] = { price: parseInt(price), quantity: 1 };
      }
      saveOrder();
      renderOrder();
    }
    function decreaseQuantity(item) {
      if(order[item]) {
        order[item].quantity -= 1;
        if(order[item].quantity <= 0) {
          delete order[item];
        }
        saveOrder();
        renderOrder();
      }
    }
    function removeItem(item) {
      delete order[item];
      saveOrder();
      renderOrder();
    }
    function renderOrder() {
      const orderList = document.getElementById('order-list');
      const orderSummary = document.getElementById('order-summary');
      orderList.innerHTML = '';
      let total = 0;
      for (const [item, details] of Object.entries(order)) {
        const li = document.createElement('li');
        li.innerHTML = `
          ${item} - ${details.quantity} × ${details.price.toLocaleString()} ل.ل = ${(details.price * details.quantity).toLocaleString()} ل.ل
          <button class=\"decrease-btn\" onclick=\"decreaseQuantity('${item}')\">-</button>
          <button onclick=\"addToOrder('${item}', '${details.price}')\">+</button>
          <button class=\"delete-btn\" onclick=\"removeItem('${item}')\">حذف</button>
        `;
        orderList.appendChild(li);
        total += details.price * details.quantity;
      }
      orderSummary.textContent = `الإجمالي: ${total.toLocaleString()} ل.ل`;
    }

    // Delivery Modal Logic
    const deliveryBtn = document.getElementById('deliveryBtn');
    const deliveryModal = document.getElementById('deliveryModal');
    const deliverySelect = document.getElementById('deliverySelect');
    const deliveryPrices = {
      saksakie: 100,
      loubie: 200,
      bablie: 200,
      sarafand: 200,
      saksakie_khayzaran: 200
    };
    const deliveryNames = {
      saksakie: 'سكسكية',
      loubie: 'لوبية',
      bablie: 'بابليّة',
      sarafand: 'الصرفند',
      saksakie_khayzaran: 'سكسكية خيزران'
    };
    deliveryBtn.onclick = function() {
      deliveryModal.style.display = 'flex';
      document.querySelector('input[name="deliveryType"][value="with"]').checked = true;
      deliverySelect.disabled = false;
      deliverySelect.value = '';
    };
    document.addEventListener('DOMContentLoaded', function() {
      const radios = document.getElementsByName('deliveryType');
      radios.forEach(radio => {
        radio.addEventListener('change', function() {
          if(this.value === 'with') {
            deliverySelect.disabled = false;
          } else {
            deliverySelect.disabled = true;
            deliverySelect.value = '';
          }
        });
      });
    });
    function closeDeliveryModal() {
      deliveryModal.style.display = 'none';
    }
    function sendOrderToWhatsApp() {
      if(Object.keys(order).length === 0) {
        alert('لم تقم بإضافة أي صنف للطلب.');
        return;
      }
      let message = 'طلب جريش من معجنات نعمة:\n\n';
      for (const [item, details] of Object.entries(order)) {
        message += `${item} - ${details.quantity} × ${details.price.toLocaleString()} ل.ل = ${(details.price * details.quantity).toLocaleString()} ل.ل\n`;
      }
      const total = Object.values(order).reduce((sum, details) => sum + details.price * details.quantity, 0);
      message += `\nالإجمالي: ${total.toLocaleString()} ل.ل`;
      const deliveryType = document.querySelector('input[name="deliveryType"]:checked').value;
      const selected = deliverySelect.value;
      if(deliveryType === 'with' && selected && deliveryPrices[selected]) {
        message += `\nالتوصيل إلى: ${deliveryNames[selected]}\nسعر التوصيل: ${deliveryPrices[selected].toLocaleString()} ل.ل`;
      } else {
        message += '\nبدون توصيل';
      }
      const phone = '+96176657606';
      const url = `https://wa.me/${phone}?text=${encodeURIComponent(message)}`;
      window.open(url, '_blank');
      closeDeliveryModal();
    }

    renderMenuPage();
    renderOrder();
    window.addEventListener('storage', (event) => {
      if(event.key === 'order_all') {
        order = JSON.parse(event.newValue) || {};
        renderOrder();
      }
    });
  </script>

